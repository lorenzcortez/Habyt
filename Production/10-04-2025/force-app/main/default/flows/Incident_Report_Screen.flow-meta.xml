<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>58.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <choices>
        <name>NoChoiceSelected</name>
        <choiceText>-- None Selected --</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>-- None Selected --</stringValue>
        </value>
    </choices>
    <decisions>
        <name>Type_Selected</name>
        <label>Type Selected</label>
        <locationX>314</locationX>
        <locationY>350</locationY>
        <defaultConnector>
            <targetReference>Error_Screen</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Bodily_Injured</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Incident_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Bodily Injury</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Bodily_Injured_Screen</targetReference>
            </connector>
            <label>Bodily Injured</label>
        </rules>
        <rules>
            <name>Property_Damaged</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Incident_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Property Damage</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Property_Damage_Screen</targetReference>
            </connector>
            <label>Property Damaged</label>
        </rules>
    </decisions>
    <description>Final version with updated UI and testing by Zach</description>
    <dynamicChoiceSets>
        <name>Incident_Type</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Incident_Type__c</picklistField>
        <picklistObject>Case</picklistObject>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <name>serverUrl</name>
        <dataType>String</dataType>
        <expression>{!$Api.Partner_Server_URL_370}</expression>
    </formulas>
    <interviewLabel>Incident Report Screen {!$Flow.CurrentDateTime}</interviewLabel>
    <label>CSS - Incident Report Screen</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>CaseRecord</name>
        <label>CaseRecord</label>
        <locationX>314</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Type_of_Incident</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Case_Record</name>
        <label>Update Case Record</label>
        <locationX>50</locationX>
        <locationY>566</locationY>
        <connector>
            <targetReference>Success_Screen</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Date_of_Accident__c</field>
            <value>
                <elementReference>Date_of_Accident_m</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description_of_Incident__c</field>
            <value>
                <elementReference>Description_of_Incident</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Incident_Type__c</field>
            <value>
                <elementReference>Incident_Type</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Location_of_Incident__c</field>
            <value>
                <elementReference>Location_of_Incident_2</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name_of_Injured_Party_ies__c</field>
            <value>
                <elementReference>Name_of_Injured_Party_ies</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name_of_Witnesses__c</field>
            <value>
                <elementReference>Name_of_Witnesses</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Case_Record2</name>
        <label>Update Case Record</label>
        <locationX>314</locationX>
        <locationY>566</locationY>
        <connector>
            <targetReference>Success_Screen</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Date_of_Accident__c</field>
            <value>
                <elementReference>Date_of_Accident_m</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Extent_of_Damages__c</field>
            <value>
                <elementReference>What_was_the_extent_of_the_damage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Incident_Type__c</field>
            <value>
                <elementReference>Incident_Type</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Location_of_Incident__c</field>
            <value>
                <elementReference>Location_of_Incident_2</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Nature_Cause_of_Loss__c</field>
            <value>
                <elementReference>What_caused_the_damage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Property_Secured_How__c</field>
            <value>
                <elementReference>How_has_Common_secured_the_property</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Remediation_Services_Contact__c</field>
            <value>
                <elementReference>Have_we_been_in_touch_with_another_Insurance_Company_If_so_what_is_their_contact</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <screens>
        <name>Bodily_Injured_Screen</name>
        <label>Bodily Injured</label>
        <locationX>50</locationX>
        <locationY>458</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Update_Case_Record</targetReference>
        </connector>
        <fields>
            <name>BodilyInjuryDisplayText</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(196, 86, 63); font-size: 18px;&quot;&gt;BODILY INJURY INCIDENT REPORT&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;Please update the fields below providing details about the incident that occurred.  At a later step this information will be used to populate the incident report sent to legal.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Name_of_Injured_Party_ies</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>CaseRecord.Name_of_Injured_Party_ies__c</elementReference>
            </defaultValue>
            <fieldText>Name of Injured Party(ies)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Name_of_Witnesses</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>CaseRecord.Name_of_Witnesses__c</elementReference>
            </defaultValue>
            <fieldText>Name of Witnesses</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Description_of_Incident</name>
            <defaultValue>
                <stringValue>{!CaseRecord.Description_of_Incident__c}</stringValue>
            </defaultValue>
            <fieldText>Description of Incident (Please specify the bodily injury that the member sustained)</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Error_Screen</name>
        <label>Error Screen</label>
        <locationX>578</locationX>
        <locationY>458</locationY>
        <allowBack>true</allowBack>
        <allowFinish>false</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>None_Selected_Message</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(196, 86, 63); background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;WHOOPS.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(196, 86, 63); background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;Please return to the previous screen and select an &lt;/span&gt;&lt;b style=&quot;color: rgb(196, 86, 63); background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;incident type&lt;/b&gt;&lt;span style=&quot;color: rgb(196, 86, 63); background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt; to continue.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Property_Damage_Screen</name>
        <label>Property Damage Screen</label>
        <locationX>314</locationX>
        <locationY>458</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_Case_Record2</targetReference>
        </connector>
        <fields>
            <name>PropertyDamageDisplayText</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 18px; color: rgb(196, 86, 63);&quot;&gt;PROPERTY DAMAGE INCIDENT REPORT&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 16px;&quot;&gt;Please update the fields below providing details about the incident that occurred.  At a later step this information will be used to populate the incident report sent to legal.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>What_caused_the_damage</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>CaseRecord.Nature_Cause_of_Loss__c</elementReference>
            </defaultValue>
            <fieldText>What caused the damage?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>What_was_the_extent_of_the_damage</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>CaseRecord.Extent_of_Damages__c</elementReference>
            </defaultValue>
            <fieldText>What was the extent of the damage?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>How_has_Common_secured_the_property</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>CaseRecord.Property_Secured_How__c</elementReference>
            </defaultValue>
            <fieldText>How has Common secured the property?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Have_we_been_in_touch_with_another_Insurance_Company_If_so_what_is_their_contact</name>
            <defaultValue>
                <stringValue>{!CaseRecord.Remediation_Services_Contact__c}</stringValue>
            </defaultValue>
            <fieldText>Have we been in touch with another Insurance Company? If so, what is their contact information?</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Success_Screen</name>
        <label>Success Screen</label>
        <locationX>314</locationX>
        <locationY>758</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Success_Message</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 20px; color: rgb(196, 86, 63);&quot;&gt;Wait! One last step to complete:&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://common.lightning.force.com/apex/APXTConga4__Conga_Composer?SolMgr=1&amp;amp;serverUrl={!serverUrl}&amp;amp;Id={!recordId}&amp;amp;EmailToId=0033u00001DHMKSAA5&amp;amp;EmailReplyToId=0056A000002T89KQAS&amp;amp;TemplateGroup=Incident%20Report&amp;amp;CongaEmailTemplateId=a453u000001iZsm&amp;amp;TemplateId=a4E3u000000MIuR&amp;amp;SC0=1&amp;amp;SC1=SalesforceFile&amp;amp;AC0=1&amp;amp;AC1=Incident%20Report%20|%20{!CaseRecord.Account_First_Name__c}&amp;amp;CETFilter=Name__c%20INCLUDES%20(%27Incident%20Report%27)&quot; target=&quot;_blank&quot; style=&quot;font-size: 20px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;b&gt;&lt;u&gt;CLICK HERE&lt;/u&gt; to generate an incident report and send it to Legal&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Type_of_Incident</name>
        <label>Type of Incident</label>
        <locationX>314</locationX>
        <locationY>242</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Type_Selected</targetReference>
        </connector>
        <fields>
            <name>IncidentReport</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 18px; color: rgb(196, 86, 63);&quot;&gt;INCIDENT REPORT&lt;/b&gt;&lt;/p&gt;&lt;p&gt;An Incident Report should be completed whenever a member experiences a potential case of Bodily Injury or Property Damage that may result in litigation. &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;You must select a type of incident in order to move forward.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>What_type_of_incident_are_you_reporting</name>
            <choiceReferences>NoChoiceSelected</choiceReferences>
            <choiceReferences>Incident_Type</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>NoChoiceSelected</defaultSelectedChoiceReference>
            <fieldText>What type of incident are you reporting?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Date_of_Accident_m</name>
            <dataType>Date</dataType>
            <fieldText>Date of Accident</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Date of Accident can not be greater than today.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>{!Date_of_Accident_m} &lt;= {!$Flow.CurrentDate}</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>Location_of_Incident_2</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>CaseRecord.Location_of_Incident__c</elementReference>
            </defaultValue>
            <fieldText>Location of Incident</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>188</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>CaseRecord</targetReference>
        </connector>
    </start>
    <status>Obsolete</status>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
